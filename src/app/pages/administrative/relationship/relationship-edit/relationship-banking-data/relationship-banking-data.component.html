@if (isWriting()) {
  <div class="row mt-3">
    <div class="col-md-4">
      <h2 class="fw-bold text-break">
        {{ titleLabel() | translate }}
        <app-warning-status [row]="{ error: error(), warning: warning() }"></app-warning-status>
      </h2>
    </div>

    <div class="col-md-8">
      <div class="form-group-mb-3">
        <div class="card">
          <div class="row mt-3">
            <div class="col-md-4">
              <p class="fw-bold text-break">{{ titleLabelCard() | translate }}</p>
              <p>{{ 'administrative.relationshipEdit.relationshipBankingData.searchBank' | translate }}</p>
            </div>
          </div>
          <div class="row mt-3 container p-0">
            <div class="col-md-5 d-flex align-items-center">
              <div class="form-group mb-3 d-flex align-items-center">
                <gls-input
                  [id]="'abi'"
                  [formGroup]="relationshipBankingDataForm()"
                  [controlName]="getFieldControlName('abi')"
                  [label]="getLabel('abi') | translate"
                  [placeholder]="getLabel('abi') | translate"
                  [type]="'text'"
                  [class]="'form-control'"
                  [showError]="true"
                  [showStatus]="false" />
                @if (showErrorForm('abi')) {
                  <span class="gls-field-span gls-field-icon-ko ms-3"
                        [ngClass]="relationshipBankingDataForm().get(this.getFieldControlName('abi'))?.touched ? 'my-auto' : 'mt-4'">
                    <em class="bi bi-exclamation-circle"></em>
                  </span>
                }
              </div>
            </div>
            <div class="col-md-5">
              <div class="form-group mb-3 d-flex align-items-center">
                <gls-input
                  [id]="'cab'"
                  [formGroup]="relationshipBankingDataForm()"
                  [controlName]="getFieldControlName('cab')"
                  [label]="getLabel('cab') | translate"
                  [placeholder]="getLabel('cab') | translate"
                  [type]="'text'"
                  [class]="'form-control'"
                  [showError]="true"
                  [showStatus]="false" />
                @if (showErrorForm('cab')) {
                  <span class="gls-field-span gls-field-icon-ko ms-3"
                        [ngClass]="relationshipBankingDataForm().get(this.getFieldControlName('cab'))?.touched ? 'my-auto' : 'mt-4'">
                    <em class="bi bi-exclamation-circle"></em>
                  </span>
                }
              </div>
            </div>
            <div class="col-lg-2 mt-md-4">
              <button (click)="searchBank()" class="btn btn-outline-primary" [disabled]="searchDisable()">
                <span>
                  {{ 'generic.search' | translate }}
                </span>
              </button>
            </div>
          </div>
          @if (bankDetail) {
            <ng-container>
              <p class="mt-3">{{ 'administrative.relationshipEdit.relationshipBankingData.title' | translate }}</p>
              <div class="row bank-detail-row">
                <div class="col-md-6">{{ getLabel('abi') | translate }}</div>
                <div class="col-md-6">{{ bankDetail.abiCode }}</div>
              </div>
              <div class="row bank-detail-row">
                <div class="col-md-6">{{ getLabel('cab') | translate }}</div>
                <div class="col-md-6">{{ bankDetail.cabCode }}</div>
              </div>
              <div class="row bank-detail-row">
                <div class="col-md-6">{{ getLabel('bankDescription') | translate }}</div>
                <div class="col-md-6">{{ bankDetail.bankDescription }}</div>
              </div>
              <div class="row bank-detail-row">
                <div class="col-md-6">{{ getLabel('agencyDescription') | translate }}</div>
                <div class="col-md-6">{{ bankDetail.bankAgencyDescription }}</div>
              </div>
            </ng-container>
          }

          @if (showEmptyMsg()) {
            <div class="alert alert-danger my-3" role="alert">
              {{ 'administrative.relationshipEdit.relationshipBankingData.bankNotFound' | translate }}
            </div>
          }
        </div>
      </div>

      <div class="form-group mb-3">
        <gls-input
          [id]="getFieldControlName('accountNumber')"
          [formGroup]="relationshipBankingDataForm()"
          [controlName]="getFieldControlName('accountNumber')"
          [label]="'administrative.relationshipEdit.relationshipBankingData.accountNumber' | translate"
          [placeholder]="'administrative.relationshipEdit.relationshipBankingData.accountNumber' | translate"
          [type]="'text'"
          [class]="'form-control'"
          [showError]="true"
          [showStatus]="true"
          (glsBlur)="onAccountNumberBlur()">
        </gls-input>
      </div>
      <div class="form-group mb-3">
        <gls-input
          [id]="getFieldControlName('cin')"
          [formGroup]="relationshipBankingDataForm()"
          [controlName]="getFieldControlName('cin')"
          [label]="'administrative.relationshipEdit.relationshipBankingData.cin' | translate"
          [placeholder]="'administrative.relationshipEdit.relationshipBankingData.cin' | translate"
          [type]="'text'"
          [class]="'form-control'"
          [showError]="true"
          [showStatus]="true">
        </gls-input>
      </div>
      <div class="form-group mb-3">
        <gls-input
          [id]="getFieldControlName('iban')"
          [formGroup]="relationshipBankingDataForm()"
          [controlName]="getFieldControlName('iban')"
          [label]="'administrative.relationshipEdit.relationshipBankingData.iban' | translate"
          [placeholder]="'administrative.relationshipEdit.relationshipBankingData.iban' | translate"
          [type]="'text'"
          [class]="'form-control'"
          [showError]="true"
          [showStatus]="true">
        </gls-input>
      </div>
      <div class="form-group mb-3">
        <gls-input
          [id]="getFieldControlName('bic')"
          [formGroup]="relationshipBankingDataForm()"
          [controlName]="getFieldControlName('bic')"
          [label]="'administrative.relationshipEdit.relationshipBankingData.bic' | translate"
          [placeholder]="'administrative.relationshipEdit.relationshipBankingData.bic' | translate"
          [type]="'text'"
          [class]="'form-control'"
          [showError]="true"
          [showStatus]="true">
        </gls-input>
      </div>
      @if (!isRemittance()) {
        <div class="form-group mb-3">
          <gls-input
            [id]="'bankCredit'"
            [formGroup]="relationshipBankingDataForm()"
            [controlName]="'bankCredit'"
            [label]="'administrative.relationshipEdit.relationshipBankingData.bankCredit' | translate"
            [placeholder]="'administrative.relationshipEdit.relationshipBankingData.bankCredit' | translate"
            [type]="'decimal'"
            [class]="'form-control'"
            [showError]="true"
            [showStatus]="true">
          </gls-input>
        </div>
      }
    </div>
  </div>
} @else {
  <div class="row mb-3 mt-3">
    <div class="col-md-6">
      <h2 class="fw-bold">
        {{ titleLabel() | translate }}
        <app-warning-status [row]="{ error: error(), warning: warning() }"></app-warning-status>
      </h2>
    </div>

    <div class="col-md-6">
      <div class="row mb-2">
        <div class="col-6 fw-bold text-break">
          {{ getLabel('abi') | translate }}
        </div>
        <div
          class="col-6 text-break">{{ relationshipBankingDataForm().get(getFieldControlName('abi'))?.value || '--' }}
        </div>
      </div>
      <div class="row mb-2">
        <div class="col-6 fw-bold text-break">
          {{ getLabel('cab') | translate }}
        </div>
        <div
          class="col-6 text-break">{{ relationshipBankingDataForm().get(getFieldControlName('cab'))?.value || '--' }}
        </div>
      </div>
      @if (bankDetail) {
        <div class="row mb-2">
          <div class="col-6 fw-bold text-break">
            {{ getLabel('bankDescription') | translate }}
          </div>
          <div class="col-6 text-break">{{ bankDetail.bankDescription || '--' }}</div>
        </div>
        <div class="row mb-2">
          <div class="col-6 fw-bold text-break">
            {{ getLabel('agencyDescription') | translate }}
          </div>
          <div class="col-6 text-break">{{ bankDetail.bankAgencyDescription || '--' }}</div>
        </div>
      }
      <div class="row mb-2">
        <div class="col-6 fw-bold text-break">
          {{ 'administrative.relationshipEdit.relationshipBankingData.accountNumber' | translate }}
        </div>
        <div
          class="col-6 text-break">{{ relationshipBankingDataForm().get(getFieldControlName('accountNumber'))?.value || '--' }}
        </div>
      </div>
      <div class="row mb-2">
        <div class="col-6 fw-bold text-break">
          {{ 'administrative.relationshipEdit.relationshipBankingData.cin' | translate }}
        </div>
        <div
          class="col-6 text-break">{{ relationshipBankingDataForm().get(getFieldControlName('cin'))?.value || '--' }}
        </div>
      </div>
      <div class="row mb-2">
        <div class="col-6 fw-bold text-break">
          {{ 'administrative.relationshipEdit.relationshipBankingData.iban' | translate }}
        </div>
        <div
          class="col-6 text-break">{{ relationshipBankingDataForm().get(getFieldControlName('iban'))?.value || '--' }}
        </div>
      </div>
      <div class="row mb-2">
        <div class="col-6 fw-bold text-break">
          {{ 'administrative.relationshipEdit.relationshipBankingData.bic' | translate }}
        </div>
        <div
          class="col-6 text-break">{{ relationshipBankingDataForm().get(getFieldControlName('bic'))?.value || '--' }}
        </div>
      </div>
      @if (!isRemittance()) {
        <div class="row mb-2">
          <div class="col-6 fw-bold text-break">
            {{ 'administrative.relationshipEdit.relationshipBankingData.bankCredit' | translate }}
          </div>
          <div
            class="col-6 text-break">{{ (relationshipBankingDataForm().get('bankCredit')?.value | number) || '--' }}
          </div>
        </div>
      }
    </div>
  </div>
}
